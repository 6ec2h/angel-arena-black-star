boss_kel_thuzad_invulnerability = class({})
LinkLuaModifier("modifier_boss_kel_thuzad_invulnerability_magical", "heroes/bosses/kel_thuzad/modifier_boss_kel_thuzad_invulnerability.lua", LUA_MODIFIER_MOTION_NONE)
LinkLuaModifier("modifier_boss_kel_thuzad_invulnerability_physical", "heroes/bosses/kel_thuzad/modifier_boss_kel_thuzad_invulnerability.lua", LUA_MODIFIER_MOTION_NONE)
function boss_kel_thuzad_invulnerability:GetCooldown()
	local caster = self:GetCaster()
	local stacks = caster:GetModifierStackCount("modifier_boss_kel_thuzad_immortality", caster)
	return self:GetSpecialValueFor(caster:HasModifier("modifier_boss_kel_thuzad_immortality") and stacks <= self:GetSpecialValueFor("reduced_stacks") and "reduced_cooldown" or "normal_cooldown")
end

function boss_kel_thuzad_invulnerability:GetIntrinsicModifierName()
	return "modifier_boss_kel_thuzad_invulnerability_magical"
end

if IsServer() then
	function boss_kel_thuzad_invulnerability:OnToggle()
		local caster = self:GetCaster()
		if self:GetToggleState() then
			caster:RemoveModifierByName("modifier_boss_kel_thuzad_invulnerability_magical")
			caster:AddNewModifier(caster, self, "modifier_boss_kel_thuzad_invulnerability_physical", nil)
		else
			self:StartCooldown(self:GetCooldown())
			caster:RemoveModifierByName("modifier_boss_kel_thuzad_invulnerability_physical")
			caster:AddNewModifier(caster, self, "modifier_boss_kel_thuzad_invulnerability_magical", nil)
		end
	end
end